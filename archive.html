<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ø£Ø±Ø´ÙØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#0b63d6;
      --muted:#6b7280;
      --bg:#f8fafc;
      --card:#ffffff;
      --radius:12px;
      --maxw:1000px;
      --pad:18px;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    html,body{height:100%;background:var(--bg);color:#0f172a;margin:0}
    .wrap{max-width:var(--maxw);margin:28px auto;padding:24px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;flex-wrap:wrap}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#6c9df0);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
    h1{font-size:20px;margin:0}
    .subtitle{color:var(--muted);font-size:13px}

    .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    button, .btn{background:var(--accent);color:white;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(11,99,214,0.12)}
    .card{background:var(--card);border-radius:var(--radius);padding:var(--pad);box-shadow:0 6px 18px rgba(12,22,37,0.06);}

    form.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{display:block;font-size:13px;margin-bottom:6px}
    input[type=text], input[type=date], textarea{width:100%;padding:10px;border-radius:10px;border:1px solid #e6eef8;font-size:14px}
    textarea{min-height:90px;resize:vertical}
    .full{grid-column:1/-1}

    .search-box{margin:10px 0 20px 0;display:flex;gap:8px;align-items:center}
    .search-box input{flex:1;padding:10px;border:1px solid #e5e7eb;border-radius:10px;font-size:14px}

    .share-box{margin:10px 0 20px 0;display:flex;gap:8px;align-items:center}
    .share-box input{flex:1;padding:10px;border:1px solid #e5e7eb;border-radius:10px;font-size:14px;direction:ltr}

    .list-wrap{margin-top:18px}
    ol.projects{counter-reset:proj;list-style:none;padding:0;margin:0;display:grid;gap:12px}
    ol.projects li{counter-increment:proj;background:linear-gradient(180deg,rgba(255,255,255,0.98),var(--card));padding:14px;border-radius:10px;display:flex;gap:12px;align-items:flex-start}
    ol.projects li::before{content:counter(proj);flex:0 0 44px;height:44px;border-radius:8px;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px}
    .project-main{flex:1}
    .meta{display:flex;gap:12px;flex-wrap:wrap;color:var(--muted);font-size:13px;margin-bottom:6px}
    .meta span{background:#f1f5f9;padding:6px 8px;border-radius:8px}

    .actions{display:flex;gap:8px}
    .small{padding:8px 10px;font-size:13px;border-radius:8px}

    footer{margin-top:20px;color:var(--muted);font-size:13px;text-align:center}

    @media (max-width:720px){
      form.grid{grid-template-columns:1fr}
      header{flex-direction:column;align-items:flex-start}
    }

    @media print{
      body{background:white}
      .controls, .no-print, .search-box, .share-box{display:none}
      header{margin-bottom:8px}
      .wrap{box-shadow:none;margin:0;padding:0}
      ol.projects li{page-break-inside:avoid}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="no-print">
      <div class="brand">
        <div class="logo">Ø£Ø±Ø´</div>
        <div>
          <h1>Ù†Ø¸Ø§Ù… Ø£Ø±Ø´ÙØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h1>
          <div class="subtitle">ØµÙØ­Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ù…Ø´Ø§Ø±ÙŠØ¹Ùƒ</div>
        </div>
      </div>
      <div class="controls">
        <button id="savePdf">Ø­ÙØ¸ ÙƒÙ€ PDF</button>
        <button class="btn ghost" id="exportJson">ØªØµØ¯ÙŠØ± JSON</button>
        <button class="btn ghost" id="shareLink">Ù…Ø´Ø§Ø±ÙƒØ©</button>
        <button class="btn ghost" id="clearAll">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
      </div>
    </header>

    <section class="card">
      <form id="projectForm" class="grid" autocomplete="off">
        <div>
          <label for="name">Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
          <input id="name" type="text" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø´Ø±ÙˆØ¹ ØªØ·ÙˆÙŠØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©">
        </div>
        <div>
          <label for="date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
          <input id="date" type="date">
        </div>
        <div class="full">
          <label for="description">ÙˆØµÙ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
          <textarea id="description" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙÙ‹Ø§ Ù…Ø®ØªØµØ±Ø§Ù‹ ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ§Ù‹ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹..."></textarea>
        </div>
        <div>
          <label for="location">Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
          <input id="location" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø¯Ù…Ø§Ù… - Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">
        </div>
        <div style="display:flex;align-items:center;gap:8px;">
          <button id="addProject" type="button">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</button>
          <button id="updateProject" type="button" class="btn ghost" style="display:none">ØªØ­Ø¯ÙŠØ«</button>
          <button id="resetForm" type="button" class="btn ghost">ØªÙØ±ÙŠØº</button>
        </div>
      </form>
    </section>

    <section class="list-wrap">
      <div class="card">
        <h3 style="margin-top:0">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h3>
        <div class="search-box no-print">
          <input id="search" type="text" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø£Ùˆ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù…...">
        </div>
        <div class="share-box no-print" id="shareBox" style="display:none;">
          <input id="shareUrl" readonly>
          <button id="copyLink" class="btn small">Ù†Ø³Ø®</button>
        </div>
        <ol id="projects" class="projects" aria-live="polite"></ol>
        <div style="margin-top:12px;color:var(--muted);font-size:13px">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹: <span id="count">0</span></div>
      </div>
    </section>

    <footer class="no-print">Ù…ÙˆÙ„Ø¯ Ø¨ÙˆØ§Ø³Ø·Ø© Ù‚Ø§Ù„Ø¨ Ø£Ø±Ø´ÙØ© â€” Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¨Ø³Ù‡ÙˆÙ„Ø©</footer>
  </div>

  <script>
    const STORAGE_KEY = 'project_archive_v1';
    let projects = [];
    let editIndex = -1;

    const projectsEl = document.getElementById('projects');
    const countEl = document.getElementById('count');
    const searchInput = document.getElementById('search');
    const shareBtn = document.getElementById('shareLink');
    const shareBox = document.getElementById('shareBox');
    const shareUrl = document.getElementById('shareUrl');
    const copyLinkBtn = document.getElementById('copyLink');

    const nameInput = document.getElementById('name');
    const dateInput = document.getElementById('date');
    const descInput = document.getElementById('description');
    const locInput = document.getElementById('location');

    const addBtn = document.getElementById('addProject');
    const updateBtn = document.getElementById('updateProject');
    const resetBtn = document.getElementById('resetForm');
    const savePdfBtn = document.getElementById('savePdf');
    const exportJsonBtn = document.getElementById('exportJson');
    const clearAllBtn = document.getElementById('clearAll');

    const params = new URLSearchParams(window.location.search);
    const shared = params.get('data');
    if(shared){
      try{projects = JSON.parse(atob(decodeURIComponent(shared)));localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));}catch(e){projects=[];}
    }else{
      projects = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    }

    function render(filter=''){
      projectsEl.innerHTML = '';
      let filtered = projects.filter((p,i)=>{const idx=(i+1).toString();const txt=`${p.name} ${p.date} ${idx}`.toLowerCase();return txt.includes(filter.toLowerCase());});
      filtered.forEach((p,i)=>{
        const li=document.createElement('li');li.setAttribute('data-index',i);
        const main=document.createElement('div');main.className='project-main';
        const title=document.createElement('div');title.style.fontWeight='700';title.textContent=p.name||'â€” Ø§Ø³Ù… ØºÙŠØ± Ù…ÙØ¯Ø®Ù„ â€”';
        const meta=document.createElement('div');meta.className='meta';
        const date=document.createElement('span');date.textContent=p.date?new Date(p.date).toLocaleDateString('ar-EG'):'ØªØ§Ø±ÙŠØ® ØºÙŠØ± Ù…ÙØ¯Ø®Ù„';
        const loc=document.createElement('span');loc.textContent=p.location||'Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ÙØ¯Ø®Ù„';
        meta.appendChild(date);meta.appendChild(loc);
        const desc=document.createElement('div');desc.textContent=p.description||'Ø¨Ø¯ÙˆÙ† ÙˆØµÙ';desc.style.color='var(--muted)';main.appendChild(title);main.appendChild(meta);main.appendChild(desc);
        const actions=document.createElement('div');actions.className='actions no-print';
        const edit=document.createElement('button');edit.className='small';edit.textContent='ØªØ¹Ø¯ÙŠÙ„';edit.onclick=()=>startEdit(i);
        const del=document.createElement('button');del.className='small';del.textContent='Ø­Ø°Ù';del.onclick=()=>removeProject(i);
        actions.appendChild(edit);actions.appendChild(del);li.appendChild(main);li.appendChild(actions);projectsEl.appendChild(li);
      });
      countEl.textContent=projects.length;localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
    }

    function clearForm(){nameInput.value='';dateInput.value='';descInput.value='';locInput.value='';editIndex=-1;updateBtn.style.display='none';addBtn.style.display='inline-block';}
    function addProject(){const p={name:nameInput.value.trim(),date:dateInput.value||null,description:descInput.value.trim(),location:locInput.value.trim()};if(!p.name&&!p.date&&!p.description&&!p.location){alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø­Ù‚Ù„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.');return;}projects.push(p);render(searchInput.value);clearForm();}
    function startEdit(i){const p=projects[i];nameInput.value=p.name||'';dateInput.value=p.date||'';descInput.value=p.description||'';locInput.value=p.location||'';editIndex=i;updateBtn.style.display='inline-block';addBtn.style.display='none';window.scrollTo({top:0,behavior:'smooth'});}
    function updateProject(){if(editIndex<0)return;projects[editIndex]={name:nameInput.value.trim(),date:dateInput.value||null,description:descInput.value.trim(),location:locInput.value.trim()};render(searchInput.value);clearForm();}
    function removeProject(i){if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŸ'))return;projects.splice(i,1);render(searchInput.value);}
    function exportJSON(){const dataStr=JSON.stringify({exportedAt:new Date().toISOString(),projects},null,2);const blob=new Blob([dataStr],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='projects-archive.json';document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(url);}
    function clearAll(){if(!confirm('Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹. Ù…ØªØ§Ø¨Ø¹Ø©ØŸ'))return;projects=[];render(searchInput.value);clearForm();}
    function generateShareLink(){const encoded=encodeURIComponent(btoa(JSON.stringify(projects)));const url=`${location.origin}${location.pathname}?data=${encoded}`;shareUrl.value=url;shareBox.style.display='flex';}

    copyLinkBtn.addEventListener('click',()=>{navigator.clipboard.writeText(shareUrl.value);copyLinkBtn.textContent='ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ”';setTimeout(()=>copyLinkBtn.textContent='Ù†Ø³Ø®',2000);});
    searchInput.addEventListener('input',()=>render(searchInput.value));
    addBtn.addEventListener('click',addProject);
    updateBtn.addEventListener('click',updateProject);
    resetBtn.addEventListener('click',clearForm);
    exportJsonBtn.addEventListener('click',exportJSON);
    clearAllBtn.addEventListener('click',clearAll);
    shareBtn.addEventListener('click',generateShareLink);
    savePdfBtn.addEventListener('click',()=>window.print());

    render();
    window.addEventListener('keydown',(e)=>{if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==='s'){e.preventDefault();window.print();}});
  </script>
</body>
</html>
